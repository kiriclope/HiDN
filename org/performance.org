#+TITLE: Performance in the Dual Task
#+STARTUP: fold
#+PROPERTY: header-args:ipython :results both :exports code :async t :session perf :kernel dual

* Imports

#+begin_src ipython
  import seaborn as sns
  import sys
  sys.path.insert(0, '../')
  from src.performance.perf_tasks import run_perf_tasks
  from src.common.fig_grid import create_grid
  from src.common.options import set_options
#+end_src

#+RESULTS:
: /home/leon/mambaforge/envs/dual/lib/python3.14/site-packages/oasis/functions.py:13: UserWarning: Could not find cvxpy. Don't worry, you can still use OASIS, just not the slower interior point methods we compared to in the papers.
:   warn("Could not find cvxpy. Don't worry, you can still use OASIS, " +

* Notebook Settings

#+begin_src ipython
    %load_ext autoreload
    %autoreload 2
    %reload_ext autoreload

    %run /home/leon/dual_task/dual_data/notebooks/setup.py
    %matplotlib inline
    %config InlineBackend.figure_format = 'png'
#+end_src

#+RESULTS:
: The autoreload extension is already loaded. To reload it, use:
:   %reload_ext autoreload
: Python exe
: /home/leon/mambaforge/envs/dual/bin/python

#+begin_src ipython
  import pickle as pkl

  def pkl_save(obj, name, path="."):
      pkl.dump(obj, open(path + "/" + name + ".pkl", "wb"))


  def pkl_load(name, path="."):
      return pkl.load(open(path + "/" + name + '.pkl', "rb"))

#+end_src

#+RESULTS:

* Performance

#+begin_src ipython
# mice = ['JawsM15']
mice = ['JawsM01', 'JawsM06', 'JawsM12', 'JawsM15', 'JawsM18', 'ChRM04', 'ChRM23', 'ACCM03', 'ACCM04']
# mice = ['AP02', 'AP12', 'PP09']
# mice = ['PP09','PP17', 'RP13']

tasks = ['DPA', "DualGo", 'DualNoGo']
perf_type = 'correct'

perf_mice = []
for mouse in mice:
    perf_ = []
    for perf_type in ['correct', 'correct_rej', 'correct_hit']:
        print('mouse', mouse, 'perf', perf_type)
        perf, ci = run_perf_tasks(mouse=mouse, perf_type=perf_type, sample='all', tasks=tasks)
        perf_.append(perf)

    while np.array(perf_).shape[-1] !=6:
        perf_ = np.append(perf_, np.nan * np.zeros((3, len(tasks), 1)), axis=-1)

    perf_mice.append(perf_)

perf_mice = np.array(perf_mice)
print(perf_mice.shape)
#+end_src

#+RESULTS:
#+begin_example
mouse JawsM01 perf correct
mouse JawsM01 perf correct_rej
mouse JawsM01 perf correct_hit
mouse JawsM06 perf correct
mouse JawsM06 perf correct_rej
mouse JawsM06 perf correct_hit
mouse JawsM12 perf correct
mouse JawsM12 perf correct_rej
mouse JawsM12 perf correct_hit
mouse JawsM15 perf correct
mouse JawsM15 perf correct_rej
mouse JawsM15 perf correct_hit
mouse JawsM18 perf correct
mouse JawsM18 perf correct_rej
mouse JawsM18 perf correct_hit
mouse ChRM04 perf correct
mouse ChRM04 perf correct_rej
#+end_example

#+begin_src ipython
pkl_save(perf_mice, './data/perf_mice.pkl')
print(perf_mice.shape)
#+end_src

#+RESULTS:
: (9, 3, 3, 6)

#+begin_src ipython
pal = ['r', 'b', 'g']
tasks = ['DPA', 'DualGo', 'DualNoGo']

days = np.arange(1, 7)
fig, ax = plt.subplots(1, 3, figsize=[3*width, height])

labels = ['DPA Performance', 'Correct Rej.', 'Hits']

for i in range(3):
   for j in range(3):
      mean_perf = np.nanmean(perf_mice[:, i, j], axis=0)
      sem_perf = np.nanstd(perf_mice[:, i, j], axis=0) / np.sqrt(perf_mice.shape[0])

      ax[i].plot(days, mean_perf, '-o', color=pal[j], label=tasks, ms=10)
      ax[i].fill_between(days, mean_perf - sem_perf, mean_perf + sem_perf, alpha=0.1, color=pal[j])
      ax[i].set_ylabel('DPA Performance')

      ax[i].set_ylabel(labels[i])

   ax[i].plot([1, 6], [.5, .5], '--k')
   ax[i].set_xlabel('Day')
   ax[i].set_xticks([1, 2, 3, 4, 5, 6])

   ax[i].set_ylim([0.45, 1.05])

   ax[i].set_yticks([0.5, 0.75, 1.0])

ax[1].set_ylim([0.25, 1.05])
plt.savefig('./figures/perf/perf_mice.svg', dpi=300)
plt.show()
#+end_src

#+RESULTS:
[[file:./.ob-jupyter/7cbc78b11289006e18e45d56c02970c32013082a.png]]

#+begin_src ipython
pal = ['r', 'b', 'g']
tasks = ['DPA', 'DualGo', 'DualNoGo']

n_mice = perf_mice.shape[0]
days = np.arange(1, 7)
fig, ax = plt.subplots(n_mice, 3, figsize=[3*width, n_mice*height])

labels = ['DPA Performance', 'Correct Rej.', 'Hits']

for k in range(n_mice):
   for i in range(3):
      for j in range(3):
         mean_perf = perf_mice[k, i, j]
         # sem_perf = np.nanstd(perf_mice[:, i, j], axis=0)

         ax[k][i].plot(days, mean_perf, '-o', color=pal[j], label=tasks, ms=10)
         # ax[k][i].fill_between(days, mean_perf - sem_perf, mean_perf + sem_perf, alpha=0.1, color=pal[j])
         ax[k][i].set_ylabel('DPA Performance')

         ax[k][i].set_ylabel(labels[i])

      ax[k][i].plot([1, 6], [.5, .5], '--k')
      ax[k][i].set_xlabel('Day')
      ax[k][i].set_xticks([1, 2, 3, 4, 5, 6])

      ax[k][i].set_ylim([0.45, 1.05])

      ax[k][i].set_yticks([0.5, 0.75, 1.0])

   ax[k][1].set_ylim([0.0, 1.05])

plt.savefig('./figures/perf/perf_idv.svg', dpi=300)
plt.show()
#+end_src

#+begin_src ipython

#+end_src

* GLM

#+begin_src ipython
mice = ['JawsM01', 'JawsM06', 'JawsM12', 'JawsM15', 'JawsM18', 'ChRM04', 'ChRM23', 'ACCM03', 'ACCM04']
kwargs = {'mice': mice}
options = set_options(**kwargs)
print(options['mice'])
#+end_src

#+RESULTS:
: 1fabdedd-35f8-4bff-a3d1-78beb0befdc2

#+begin_src ipython
from src.common.get_data import get_X_y_mice
options['reload'] = 0
X, y = get_X_y_mice(**options)
#+end_src

#+RESULTS:
: Loading files from /storage/leon/dual_task/data/mice

#+begin_src ipython
df = y[y['laser']==0].copy()
df['behavior'] = df['response'].apply(lambda x: 0 if 'incorrect' in x else 1)
df['learning'] = df['day'].apply(lambda x: 0 if x<4 else 1)
print(df.keys())
#+end_src

#+RESULTS:
: Index(['sample_odor', 'dist_odor', 'test_odor', 'tasks', 'response', 'laser',
:        'day', 'choice', 'pair', 'odr_perf', 'odr_choice', 'odr_response',
:        'odor_pair', 'mouse', 'performance', 'behavior', 'learning'],
:       dtype='object')

#+begin_src ipython
palette = sns.color_palette("muted")
pal = [palette[3], palette[0], palette[2]]

sns.lineplot(data=df, x='day', y='performance', legend=None,  marker='o', markeredgecolor='none', label='DPA', color=palette[3])
sns.lineplot(data=df, x='day', y='odr_perf', legend=None,  marker='o', markeredgecolor='none', label='GNG', color=pal[1])
sns.lineplot(data=df, x='day', y='odr_perf', legend=None, markeredgecolor='none', color=pal[2], ls='--')

plt.axhline(0.5, ls='--', color='k')
plt.xlabel('Days')
plt.ylabel('Performance')
plt.xticks(np.arange(1, 7))
plt.ylim([0.5, 1])
plt.yticks([0.5, 0.75, 1])
plt.legend(fontsize=12, frameon=0)
plt.savefig('figures/perf/dpa_gng_perf_day.svg', dpi=300)
plt.show()
#+end_src

#+RESULTS:
[[file:./.ob-jupyter/bd176ae8709ac87323dc38333a1cf6063b973588.png]]


#+begin_src ipython
palette = sns.color_palette("muted")
pal = [palette[3], palette[0], palette[2]]

df_ = df[df.pair==1]
sns.lineplot(data=df_, x='day', y='performance', legend=None,  marker='o', markeredgecolor='none', label='Paired', color=pal[0])

df_ = df[df.pair==0]
sns.lineplot(data=df_, x='day', y='performance', legend=None,  marker='o', markeredgecolor='none', label='Unpaired', color=pal[0], ls='--')

plt.axhline(0.5, ls='--', color='k')
plt.xlabel('Days')
plt.ylabel('DPA Performance')
plt.xticks(np.arange(1, 7))
# plt.xlim([1, 6])
plt.ylim([0.2, 1])
# plt.yticks([0.5, 0.75, 1])
plt.legend(fontsize=12, frameon=0)
plt.savefig('figures/perf/dpa_hits_cr_day.svg', dpi=300)
plt.show()
#+end_src

#+RESULTS:
[[file:./.ob-jupyter/e7e10ac19783f5b9d40d0d81950f594fc9cb5177.png]]


#+begin_src ipython
df_ = df[df.tasks=='DualGo']
sns.lineplot(data=df_, x='day', y='odr_perf', legend=None,  marker='o', markeredgecolor='none', label='Go', color=pal[1])

df_ = df[df.tasks=='DualNoGo']
sns.lineplot(data=df_, x='day', y='odr_perf', legend=None,  marker='o', markeredgecolor='none', label='NoGo', color=pal[2])

plt.axhline(0.5, ls='--', color='k')
plt.xlabel('Days')
plt.ylabel('GNG Performance')
plt.xticks(np.arange(1, 7))
plt.ylim([0.5, 1])
plt.yticks([0.5, 0.75, 1])
plt.xlim([1, 6])

plt.legend(fontsize=12, frameon=0)
plt.savefig('figures/perf/gng_hits_cr_day.svg', dpi=300)
plt.show()
#+end_src

#+RESULTS:
[[file:./.ob-jupyter/5f883cc6b6ae7c8f81d34baa4f4ed050c464b420.png]]

#+begin_src ipython
palette = sns.color_palette("muted")
pal = [palette[3], palette[0], palette[2],]

df_ = df[df.pair==1]
sns.lineplot(data=df_, x='day', y='performance',  hue='tasks',  marker='o', markeredgecolor='none', palette=pal)

plt.axhline(0.5, ls='--', color='k')
plt.xlabel('Days')
plt.ylabel('DPA Performance')
plt.xticks(np.arange(1, 7))
plt.ylim([0.2, 1])
plt.xlim([1, 6])

handles, labels = plt.gca().get_legend_handles_labels()
plt.legend(handles, ['DPA', 'Go', 'NoGo'], fontsize=12, frameon=0)

plt.savefig('figures/perf/dpa_tasks_days_pair.svg', dpi=300)
plt.show()
#+end_src

#+RESULTS:
[[file:./.ob-jupyter/2cbb67eabfee9b086225895f681641a060b3a778.png]]

#+begin_src ipython
df_ = df[df.pair==0]
sns.lineplot(data=df_, x='day', y='performance',  hue='tasks',  marker='o', markeredgecolor='none', palette=pal, ls='--')

plt.axhline(0.5, ls='--', color='k')
plt.xlabel('Days')
plt.ylabel('DPA Performance')
plt.xticks(np.arange(1, 7))
plt.xlim([1, 6])
plt.ylim([0.2, 1])

handles, labels = plt.gca().get_legend_handles_labels()
plt.legend(handles, ['DPA', 'Go', 'NoGo'], fontsize=12, frameon=0)

plt.savefig('figures/perf/dpa_tasks_days_unpair.svg', dpi=300)
plt.show()
#+end_src

#+RESULTS:
[[file:./.ob-jupyter/becb7c136ef72755e99b82f5005093f57a67c3db.png]]


** Errors type

#+begin_src ipython
df_ = df[df.odor_pair==0]
sns.lineplot(data=df_, x='day', y='performance',  hue='tasks',  marker='o', markeredgecolor='none', palette=pal, ls='--')

df_ = df[df.odor_pair==1]
sns.lineplot(data=df_, x='day', y='performance',  hue='tasks',  marker='o', markeredgecolor='none', palette=pal, ls='--')

plt.axhline(0.5, ls='--', color='k')
plt.xlabel('Days')
plt.ylabel('DPA Performance')
plt.xticks(np.arange(1, 7))
plt.xlim([1, 6])
plt.ylim([0.2, 1])

handles, labels = plt.gca().get_legend_handles_labels()
plt.legend(handles, ['DPA', 'Go', 'NoGo'], fontsize=12, frameon=0)

plt.savefig('figures/perf/dpa_tasks_days_unpair.svg', dpi=300)
plt.show()
#+end_src

#+RESULTS:
[[file:./.ob-jupyter/8028d52514ac66c8d73e4ae52f37cc46d8296264.png]]

#+begin_src ipython

#+end_src

* glm
#+begin_src ipython
import rpy2.robjects as robjects
from rpy2.robjects.packages import importr

# Set the .libPaths in R
custom_r_libpath = '~/R/x86_64-pc-linux-gnu-library/4.3/'
robjects.r('.libPaths("{0}")'.format(custom_r_libpath))

from pymer4.models import Lmer
#+end_src

#+RESULTS:
#+begin_example
During startup - Warning messages:
1: package ‘methods’ was built under R version 4.4.3
2: package ‘datasets’ was built under R version 4.4.3
3: package ‘utils’ was built under R version 4.4.3
4: package ‘grDevices’ was built under R version 4.4.3
5: package ‘graphics’ was built under R version 4.4.3
6: package ‘stats’ was built under R version 4.4.3
R[write to console]: In addition:
R[write to console]: Warning message:
R[write to console]: package ‘tools’ was built under R version 4.4.3
#+end_example

#+begin_src ipython
def plot_betas(results, random_effects, title, width=6, height=4):
    keys = list(results.Estimate.keys())
    n_factors = len(keys)
    n_subjects = random_effects.shape[0]

    data = []
    for key in keys:
        if key == '(Intercept)':
            # subject-level intercepts: fixed + random
            subj_betas = results.Estimate['(Intercept)'] + random_effects['(Intercept)']
        else:
            # other effects: only fixed, repeated for subjects
            subj_betas = np.repeat(results.Estimate[key], n_subjects)
        data.append(subj_betas)

    fig, ax = plt.subplots(figsize=(width, height))

    # Boxplots
    box = ax.boxplot(data, positions=np.arange(n_factors), patch_artist=True, showfliers=False, medianprops=dict(color='k', lw=2))

    cmap = plt.get_cmap('plasma')
    box_colors = [cmap(i / max(1, n_factors-1)) for i in range(n_factors)]
    for patch, color in zip(box['boxes'], box_colors):
        patch.set_facecolor(color)
        patch.set_alpha(0.5)
        patch.set_edgecolor('k')
        patch.set_linewidth(1.5)

    # Overlay points for each subject -- only on (Intercept)
    cmap2 = plt.get_cmap('tab20')
    subject_colors = [cmap2(i % 20) for i in range(n_subjects)]
    for subj in range(n_subjects):
        for i, key in enumerate(keys):
            if key == '(Intercept)':
                ax.scatter(i + 0.05*np.random.randn(), data[i][subj],
                           color=subject_colors[subj], edgecolor='k', s=40, zorder=3, alpha=0.8)
            else:
                # For other betas, no subject variability; optionally, just show the mean as a point
                pass

    # Sig stars
    for i, key in enumerate(keys):
        pval = results['P-val'][key]
        stars = '***' if pval < 0.001 else ('**' if pval < 0.01 else ('*' if pval < 0.05 else ('.' if pval < 0.1 else '')))
        if stars:
            top = max(data[i])
            ax.text(i, top*1.02, stars, fontsize=14, ha='center', va='bottom', color='black', zorder=5)

    ax.axhline(y=0, color='black', ls='--', lw=1)
    ax.set_xticks(np.arange(n_factors))
    ax.set_xticklabels(keys, rotation=45, ha='right')
    ax.set_ylabel('$\\beta$')
    ax.set_title(title, fontsize=16)

    fig.tight_layout()
    return fig, ax
#+end_src

#+RESULTS:

#+begin_src ipython
formula = 'performance ~ tasks + pair * day + (1 + day | mouse)'

model = Lmer(formula, data=df, family='binomial')
results = model.fit();
random_effects = model.ranef

print(results)
#+end_src

#+RESULTS:

#+begin_src ipython
def generate_colors(N, cmap_name='viridis'):
    cmap = plt.get_cmap(cmap_name)
    return cmap(np.linspace(0, 1, N))
#+end_src

#+RESULTS:

#+begin_src ipython
import matplotlib.pyplot as plt
import numpy as np

def plot_betas(results, random_effects, title, width=width, height=height):
    keys = list(results.Estimate.keys())
    n_factors = len(keys)
    n_subjects = random_effects.shape[0]

    # For per-subject colors
    cmap = plt.get_cmap('tab20')
    subject_colors = [cmap(i % 20) for i in range(n_subjects)]

    # Prepare data: each factor gets a vector of all subject-level betas
    data = []
    for key in keys:
        res = results.Estimate[key].copy()
        random_col = key if key in random_effects else '(Intercept)'
        res += random_effects[random_col]
        data.append(res)

    fig, ax = plt.subplots(figsize=(width, height))
    # Draw boxplots
    box = ax.boxplot(data, positions=np.arange(n_factors), patch_artist=True, showfliers=False, medianprops=dict(color='k', lw=2))

    cmap = sns.color_palette("muted")

    box_colors = [cmap[3], cmap[0], cmap[2]]
    for i in range(4, n_factors+4):
        box_colors.append(cmap[i])

    for patch, color in zip(box['boxes'], box_colors):
        patch.set_facecolor(color)
        patch.set_alpha(0.5)          # set box transparency (0=transparent, 1=opaque)
        patch.set_edgecolor('k')      # optional: black box outline
        patch.set_linewidth(1.5)

    # Overlay dotted points for each subject
    for subj in range(n_subjects):
        betas = [data[i][subj] for i in range(n_factors)]
        ax.scatter(
            np.arange(n_factors)+0.05*np.random.randn(n_factors), # jitter x
            betas,
            color=subject_colors[subj],
            edgecolor='k',
            marker='o',
            s=40,
            linewidth=0.5,
            alpha=0.8,
            linestyle=':',  # dots, not dashed
            zorder=3,
        )

    # Sig stars, as before
    for i, key in enumerate(keys):
        pval = results['P-val'][key]
        stars = '***' if pval < 0.001 else ('**' if pval < 0.01 else ('*' if pval < 0.05 else ('.' if pval < 0.1 else '')))
        if stars:
            top = max([d[subj] for d in data for subj in range(n_subjects)])
            ax.text(i, top*1, stars, fontsize=14, ha='center', va='bottom', color='black', zorder=5)

    ax.axhline(y=0, color='black', ls='--', lw=1)
    ax.set_xticks(np.arange(n_factors))
    ax.set_xticklabels(keys, rotation=45, ha='right')
    ax.set_ylabel('$\\beta$')
    ax.set_title(title, fontsize=16)

    fig.tight_layout()
    return fig, ax
#+end_src

#+RESULTS:

#+begin_src ipython
plot_betas(results, random_effects, '', height=1.25*height)
xticks = ['Intercept', 'Go', 'NoGo', 'Pair', 'Day', 'Pair * Day',]
plt.xticks(np.arange(len(xticks)), xticks, rotation=45, fontsize=14, ha='right')
plt.ylim([-2, 5])
plt.yticks(np.linspace(-2, 4, 4))
# plt.xlim([-1, 12])
plt.title('Response ~ Condition + Pair * Day', fontsize=14)

plt.savefig('figures/perf/glm_cr_perf_day.svg', dpi=300)
plt.show()
#+end_src

#+RESULTS:
[[file:./.ob-jupyter/dd573fb1dde9cd7ad1d0ac463a4502e9a9121c6e.png]]

#+begin_src ipython
import statsmodels.api as sm
import statsmodels.formula.api as smf
import pandas as pd
import matplotlib.pyplot as plt

def plot_glm_coefs(df, formula, family=sm.families.Gaussian(), xticks=None):
    # Fit GLM
    glm = smf.glm(formula=formula, data=df, family=family)
    result = glm.fit()

    # Prepare DataFrame
    coefs = result.params
    conf = result.conf_int()
    pvals = result.pvalues

    coef_df = pd.DataFrame({
        'coef': coefs,
        'ci_lower': conf[0],
        'ci_upper': conf[1],
        'pval': pvals
    })


    coef_df['signif'] = coef_df['pval'].map(
        lambda p: '***' if p < 0.001 else
        '**' if p < 0.01 else
        '*' if p < 0.05 else
        '·' if p < 0.1 else
        ''
    )

    coef_df = coef_df.reset_index().rename(columns={'index': 'term'})

    # Plot
    fig, ax = plt.subplots(figsize=(2*width, 1.25*height))
    sns.pointplot(x='term', y='coef', data=coef_df, join=False, ax=ax, scale=0.3)

    ax.errorbar(
        x=range(len(coef_df)),
        y=coef_df['coef'],
        yerr=[coef_df['coef'] - coef_df['ci_lower'], coef_df['ci_upper'] - coef_df['coef']],
        fmt='none', c='gray',
    )

    for i, star in enumerate(coef_df['signif']):
        if star:
            plt.text(i, coef_df['ci_upper'].iloc[i] + 0.02, star, ha='center', color='k', fontsize=15)

    plt.axhline(0, color='black', linewidth=0.7, linestyle='--')
    plt.ylabel('Coefficient')
    plt.xticks(rotation=45, fontsize=10)
    if xticks is not None:
        plt.xticks(np.arange(len(xticks)), xticks, rotation=45, fontsize=14)

    plt.xlabel('')
    plt.ylim([-.2, 1])
    plt.tight_layout()
    plt.savefig('figures/perf/stats_glm_perf_day.svg', dpi=300)

    plt.show()

    return result  # Optionally return the model fit for further inspection
#+end_src

#+RESULTS:

#+begin_src ipython
formula = 'performance ~ tasks * pair * day'
xticks = ['Intercept', 'Go', 'NoGo', 'Pair', 'Go * Pair', 'NoGo * Pair', 'Day', 'Go * Day', 'NoGo * Day', 'Pair * Day', 'Go * Pair * Day', 'NoGo * Pair * Day']
xticks = None
# df_ = df[df.tasks!='DPA']
result = plot_glm_coefs(df, formula, xticks=xticks)
#+end_src

#+RESULTS:
[[file:./.ob-jupyter/149fa788eb85be326dd29fd9f1742bc51573400a.png]]

#+begin_src ipython
print(result.summary())
#+end_src

#+RESULTS:
#+begin_example
                 Generalized Linear Model Regression Results
==============================================================================
Dep. Variable:            performance   No. Observations:                 3648
Model:                            GLM   Df Residuals:                     3636
Model Family:                Gaussian   Df Model:                           11
Link Function:               Identity   Scale:                         0.14047
Method:                          IRLS   Log-Likelihood:                -1590.1
Date:                Fri, 10 Oct 2025   Deviance:                       510.73
Time:                        10:53:52   Pearson chi2:                     511.
No. Iterations:                     3   Pseudo R-squ. (CS):             0.2425
Covariance Type:            nonrobust
==============================================================================================
                                 coef    std err          z      P>|z|      [0.025      0.975]
----------------------------------------------------------------------------------------------
Intercept                      0.2671      0.035      7.710      0.000       0.199       0.335
tasks[T.DualGo]               -0.0991      0.049     -2.022      0.043      -0.195      -0.003
tasks[T.DualNoGo]              0.0127      0.049      0.259      0.796      -0.083       0.109
pair                           0.5613      0.049     11.456      0.000       0.465       0.657
tasks[T.DualGo]:pair           0.0819      0.069      1.182      0.237      -0.054       0.218
tasks[T.DualNoGo]:pair        -0.0085      0.069     -0.123      0.902      -0.144       0.127
day                            0.1222      0.010     12.708      0.000       0.103       0.141
tasks[T.DualGo]:day            0.0016      0.014      0.121      0.904      -0.025       0.028
tasks[T.DualNoGo]:day         -0.0075      0.014     -0.549      0.583      -0.034       0.019
pair:day                      -0.0962      0.014     -7.070      0.000      -0.123      -0.070
tasks[T.DualGo]:pair:day       0.0001      0.019      0.005      0.996      -0.038       0.038
tasks[T.DualNoGo]:pair:day     0.0026      0.019      0.137      0.891      -0.035       0.040
==============================================================================================
#+end_example

#+begin_src ipython

#+end_src
